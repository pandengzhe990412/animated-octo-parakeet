<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Markdown è½¬æ¢æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: #007AFF;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .content {
      display: flex;
      height: 600px;
    }
    .editor-panel {
      width: 50%;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
    }
    .preview-panel {
      width: 50%;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
    }
    .panel-header {
      padding: 10px 15px;
      background: #f8f8f8;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
      font-weight: bold;
      color: #333;
    }
    .editor-textarea {
      flex: 1;
      padding: 15px;
      border: none;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      line-height: 1.6;
      resize: none;
      outline: none;
    }
    .preview-content {
      flex: 1;
      overflow: auto;
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    .phone-mockup {
      width: 375px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .phone-notch {
      background: #1c1c1e;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .phone-notch-inner {
      width: 80px;
      height: 16px;
      background: #2c2c2e;
      border-radius: 10px;
    }
    .phone-screen {
      flex: 1;
      overflow: auto;
    }
    .button-bar {
      padding: 15px;
      background: #f8f8f8;
      border-top: 1px solid #ddd;
      display: flex;
      gap: 10px;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary {
      background: #007AFF;
      color: white;
      flex: 1;
    }
    .btn-primary:hover {
      background: #0051D5;
    }
    .btn-secondary {
      background: #e0e0e0;
      color: #333;
    }
    .btn-secondary:hover {
      background: #d0d0d0;
    }
    .theme-selector {
      padding: 10px 15px;
      background: white;
      border-bottom: 1px solid #ddd;
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .theme-btn {
      padding: 6px 12px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .theme-btn.active {
      color: white;
      border-color: transparent;
    }
    .theme-btn.blue.active { background: #007AFF; }
    .theme-btn.green.active { background: #34C759; }
    .theme-btn.black.active { background: #1C1C1E; }
    .theme-btn.orange.active { background: #FF9500; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“ Markdown è½¬å…¬ä¼—å·å·¥å…· - æµ‹è¯•é¡µé¢</h1>
      <p>åœ¨å·¦ä¾§è¾“å…¥ Markdownï¼Œå³ä¾§å®æ—¶é¢„è§ˆ</p>
    </div>

    <div class="content">
      <!-- å·¦ä¾§ç¼–è¾‘å™¨ -->
      <div class="editor-panel">
        <div class="panel-header">ğŸ“ Markdown ç¼–è¾‘å™¨</div>
        <textarea
          id="editor"
          class="editor-textarea"
          placeholder="# åœ¨è¿™é‡Œè¾“å…¥ Markdown

## æ ‡é¢˜ç¤ºä¾‹

è¿™æ˜¯**ç²—ä½“**ï¼Œè¿™æ˜¯*æ–œä½“*

- åˆ—è¡¨é¡¹ 1
- åˆ—è¡¨é¡¹ 2

1. æœ‰åºåˆ—è¡¨
2. æœ‰åºåˆ—è¡¨

> è¿™æ˜¯å¼•ç”¨å—

`è¡Œå†…ä»£ç `

```
ä»£ç å—
console.log('Hello')
```

[é“¾æ¥](https://example.com)

| åˆ—1 | åˆ—2 | åˆ—3 |
|-----|-----|-----|
| A   | B   | C   |

---

åˆ†éš”çº¿"
        ></textarea>
      </div>

      <!-- å³ä¾§é¢„è§ˆ -->
      <div class="preview-panel">
        <div class="panel-header">ğŸ“± å®æ—¶é¢„è§ˆï¼ˆ375pxï¼‰</div>
        <div class="theme-selector">
          <span style="font-size: 12px; color: #666;">ä¸»é¢˜ï¼š</span>
          <button class="theme-btn blue active" onclick="setTheme('blue')">ç§‘æŠ€è“</button>
          <button class="theme-btn green" onclick="setTheme('green')">ç®€çº¦ç»¿</button>
          <button class="theme-btn black" onclick="setTheme('black')">æç®€é»‘</button>
          <button class="theme-btn orange" onclick="setTheme('orange')">æš–é˜³æ©™</button>
        </div>
        <div class="preview-content">
          <div class="phone-mockup">
            <div class="phone-notch">
              <div class="phone-notch-inner"></div>
            </div>
            <div class="phone-screen" id="preview">
              <div style="text-align: center; padding: 60px 20px; color: #999;">
                <p style="font-size: 16px; margin-bottom: 10px;">ğŸ‘‹ æ¬¢è¿ä½¿ç”¨</p>
                <p style="font-size: 14px;">åœ¨å·¦ä¾§è¾“å…¥ Markdownï¼Œå³ä¾§å®æ—¶é¢„è§ˆ</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="button-bar">
      <button class="btn-secondary" onclick="clearEditor()">æ¸…ç©ºç¼–è¾‘å™¨</button>
      <button class="btn-primary" onclick="copyToClipboard()">å¤åˆ¶åˆ°å…¬ä¼—å·</button>
    </div>
  </div>

  <script>
    const themes = {
      blue: { primary: '#007AFF', quoteBg: '#F8F8F8', codeBg: '#F8F8F8' },
      green: { primary: '#34C759', quoteBg: '#F0FFF4', codeBg: '#F8FFF8' },
      black: { primary: '#1C1C1E', quoteBg: '#F5F5F5', codeBg: '#FAFAFA' },
      orange: { primary: '#FF9500', quoteBg: '#FFF8F0', codeBg: '#FFFAF5' }
    };

    let currentTheme = 'blue';
    const editor = document.getElementById('editor');
    const preview = document.getElementById('preview');

    // Markdown è½¬ HTML
    function convertMarkdown(md, theme) {
      if (!md.trim()) {
        return `<div style="text-align: center; padding: 60px 20px; color: #999;">
          <p style="font-size: 16px; margin-bottom: 10px;">ğŸ‘‹ æ¬¢è¿ä½¿ç”¨</p>
          <p style="font-size: 14px;">åœ¨å·¦ä¾§è¾“å…¥ Markdownï¼Œå³ä¾§å®æ—¶é¢„è§ˆ</p>
        </div>`;
      }

      const t = themes[theme];
      let html = md;

      // æ ‡é¢˜
      html = html.replace(/^# (.*$)/gim, `<h1 style="color: ${t.primary}; font-size: 22px; font-weight: bold; text-align: center; margin: 30px 0 15px; padding-bottom: 10px; border-bottom: 2px solid ${t.primary};">$1</h1>`);
      html = html.replace(/^## (.*$)/gim, `<h2 style="color: ${t.primary}; font-size: 20px; font-weight: bold; margin: 25px 0 15px; padding-left: 10px;">$1</h2>`);
      html = html.replace(/^### (.*$)/gim, `<h3 style="color: ${t.primary}; font-size: 18px; font-weight: bold; margin: 20px 0 12px;">$1</h3>`);

      // ç²—ä½“
      html = html.replace(/\*\*(.*?)\*\*/gim, `<strong style="color: ${t.primary}; font-weight: bold;">$1</strong>`);
      html = html.replace(/\*(.*?)\*/gim, `<em style="font-style: italic;">$1</em>`);

      // é“¾æ¥
      html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/gim, `<a href="$2" style="color: #576b95; text-decoration: none; border-bottom: 1px dashed #576b95;">$1</a>`);

      // å›¾ç‰‡
      html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/gim, `<img src="$2" alt="$1" style="max-width: 100%; height: auto; display: block; margin: 15px auto; border-radius: 5px;" />`);

      // åˆ—è¡¨
      html = html.replace(/^\* (.*$)/gim, '<li style="margin: 8px 0; line-height: 1.75;">$1</li>');
      html = html.replace(/^- (.*$)/gim, '<li style="margin: 8px 0; line-height: 1.75;">$1</li>');
      html = html.replace(/^\d+\. (.*$)/gim, '<li style="margin: 8px 0; line-height: 1.75;">$1</li>');
      html = html.replace(/(<li[^>]*>.*<\/li>)/gim, '<ul style="margin: 15px 0; padding-left: 20px; color: #333;">$1</ul>');
      html = html.replace(/<\/ul>\s*<ul/gim, '');

      // ä»£ç å—
      html = html.replace(/```([\s\S]*?)```/gim, `<pre style="background-color: ${t.codeBg}; padding: 15px; border-radius: 5px; overflow-x: auto; margin: 15px 0; font-family: Consolas, Monaco, monospace; font-size: 14px; line-height: 1.6; color: #333; border-top: 1px solid #E0E0E0; border-bottom: 1px solid #E0E0E0; white-space: pre-wrap; word-wrap: break-word;">$1</pre>`);

      // è¡Œå†…ä»£ç 
      html = html.replace(/`([^`]+)`/gim, `<code style="color: ${t.primary}; background-color: #F0F0F0; padding: 2px 6px; border-radius: 3px; font-family: Consolas, Monaco, monospace;">$1</code>`);

      // å¼•ç”¨
      html = html.replace(/^> (.*$)/gim, `<blockquote style="border-left: 4px solid ${t.primary}; padding: 10px 15px; margin: 15px 0; background-color: ${t.quoteBg}; color: #666; font-style: italic;">$1</blockquote>`);

      // åˆ†éš”çº¿
      html = html.replace(/^---$/gim, `<hr style="border: none; border-top: 1px solid ${t.primary}; margin: 20px 0;" />`);

      // è¡¨æ ¼
      html = html.replace(/\|(.+)\|/gim, (match) => {
        const cells = match.split('|').filter(c => c.trim());
        if (cells.some(c => c.includes('---'))) return '';
        const cellStyle = 'padding: 12px; border: 1px solid #E0E0E0; text-align: left;';
        return '<tr>' + cells.map(c => `<td style="${cellStyle}">${c.trim()}</td>`).join('') + '</tr>';
      });
      html = html.replace(/(<tr[^>]*>.*<\/tr>\s*)+/gim, (match) => {
        return `<table style="width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 15px;">${match}</table>`;
      });

      // æ®µè½
      html = html.replace(/\n\n/g, '</p><p style="margin: 15px 0; text-align: justify; color: #333;">');
      html = '<p style="margin: 15px 0; text-align: justify; color: #333;">' + html + '</p>';
      html = html.replace(/<p style="[^"]*"><\/p>/g, '');

      // åŒ…è£…
      html = `<section style="max-width: 677px; margin: 0 auto; padding: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; font-size: 16px; line-height: 1.75; color: #333; word-wrap: break-word;">${html}</section>`;

      return html;
    }

    // å®æ—¶é¢„è§ˆ
    function updatePreview() {
      const md = editor.value;
      preview.innerHTML = convertMarkdown(md, currentTheme);
    }

    // è®¾ç½®ä¸»é¢˜
    function setTheme(theme) {
      currentTheme = theme;
      document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.theme-btn.${theme}`).classList.add('active');
      updatePreview();
    }

    // æ¸…ç©ºç¼–è¾‘å™¨
    function clearEditor() {
      editor.value = '';
      updatePreview();
    }

    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    async function copyToClipboard() {
      if (!editor.value.trim()) {
        alert('è¯·å…ˆè¾“å…¥ Markdown å†…å®¹');
        return;
      }

      try {
        const html = convertMarkdown(editor.value, currentTheme);
        const clipboardItem = new ClipboardItem({
          'text/html': new Blob([html], { type: 'text/html' }),
          'text/plain': new Blob([editor.value], { type: 'text/plain' })
        });
        await navigator.clipboard.write([clipboardItem]);
        alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\nç°åœ¨å¯ä»¥åœ¨å¾®ä¿¡å…¬ä¼—å·ç¼–è¾‘å™¨ä¸­ç²˜è´´ï¼ˆCtrl+Vï¼‰');
      } catch (error) {
        alert('å¤åˆ¶å¤±è´¥ï¼š' + error.message);
      }
    }

    // ç›‘å¬è¾“å…¥
    editor.addEventListener('input', updatePreview);

    // é¡µé¢åŠ è½½å®Œæˆ
    window.addEventListener('load', () => {
      console.log('âœ… æµ‹è¯•é¡µé¢å·²åŠ è½½');
      console.log('ğŸ“ åœ¨å·¦ä¾§è¾“å…¥ Markdownï¼Œå³ä¾§å®æ—¶é¢„è§ˆ');
      updatePreview();
    });
  </script>
</body>
</html>
