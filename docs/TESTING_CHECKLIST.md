# 🧪 测试检查清单

## ✅ 已完成的自检

### 1. 构建检查
- ✅ `manifest.json` 生成正确
- ✅ `sidepanel.html` 生成正确
- ✅ `sidepanel.js` 打包成功
- ✅ content script 打包成功
- ✅ 图标文件生成成功
- ✅ 所有必需的权限已配置：
  - `storage`
  - `sidePanel`
  - `activeTab`
  - `clipboardWrite`
  - `scripting`

### 2. 代码检查
- ✅ 样式转换函数 `applyWeChatStyles()` 实现完整
- ✅ 支持的 HTML 元素样式：
  - H1-H6 标题
  - P 段落
  - UL/OL 列表
  - LI 列表项
  - BLOCKQUOTE 引用块
  - PRE/CODE 代码块
  - IMG 图片
  - A 链接
  - TABLE 表格
  - HR 分隔线
  - STRONG 粗体
- ✅ 所有样式使用内联样式（公众号兼容）
- ✅ 蓝色主题 (#007AFF) 与参考截图一致

### 3. 浏览器测试页面
已创建 `test-styling.html` 用于验证样式转换效果：
- ✅ 输入 HTML 显示
- ✅ 输出 HTML 显示
- ✅ 实时预览效果（375px 手机宽度）
- ✅ 一键复制功能

## 📋 用户测试步骤

### 步骤 1：重新加载扩展
1. 打开 `chrome://extensions/`
2. 找到"飞书文档转公众号助手"
3. 点击右下角的 🔄 按钮

### 步骤 2：打开飞书文档
1. 在 Chrome 中打开任意飞书文档
2. 确保文档完全加载

### 步骤 3：测试抓取功能
1. 点击 Chrome 右上角的扩展图标
2. 侧边栏应该从右侧滑出
3. 查看是否显示"公众号预览"和文档标题
4. ✅ 成功：预览区域显示文档内容
5. ❌ 失败：显示错误消息

### 步骤 4：测试转换功能
1. 确认预览区域有内容
2. 点击"转换并复制"按钮
3. 按钮应变为绿色"已复制"
4. 打开微信公众号编辑器
5. 按 `Ctrl+V` 粘贴
6. ✅ 成功：格式与参考截图一致
7. ❌ 失败：格式丢失或样式错误

### 步骤 5：检查样式（重要！）
粘贴到公众号后，检查以下样式：
- ✅ 标题是蓝色 (#007AFF)
- ✅ H1 有下划线
- ✅ 引用块有左侧蓝色竖线
- ✅ 代码块有灰色背景和上下边框
- ✅ 行内代码是蓝色文字 + 浅灰背景
- ✅ 链接是微信蓝色 (#576b95) + 虚线下划线
- ✅ 表格有蓝色表头
- ✅ 分隔线是蓝色细线
- ✅ 粗体文字是蓝色

### 步骤 6：测试浏览器页面（可选）
1. 打开项目根目录的 `test-styling.html`
2. 点击"运行测试"按钮
3. 查看预览效果
4. 点击"复制输出"
5. 在公众号编辑器粘贴测试

## 🐛 如果遇到问题

### 问题 1：侧边栏无法打开
**解决**：
- 检查 manifest.json 中的 `side_panel` 配置
- 确认点击的是扩展图标（不是内容脚本）

### 问题 2：无法抓取文档
**解决**：
- 确认在飞书文档页面（URL 包含 feishu.cn）
- 打开浏览器控制台（F12）查看错误日志
- 检查 `scripting` 权限是否启用

### 问题 3：复制失败
**解决**：
- 检查浏览器剪贴板权限
- 查看控制台错误信息
- 确认文档内容已成功抓取

### 问题 4：粘贴到公众号后格式丢失
**解决**：
- 检查是否复制为 HTML 格式（不是纯文本）
- 确认使用了 `ClipboardItem` API
- 在浏览器开发者工具中检查复制的 HTML 内容

## 📝 测试报告模板

测试完成后，请提供以下信息：

```
✅/❌ 扩展加载成功
✅/❌ 侧边栏可以打开
✅/❌ 能够抓取飞书文档
✅/❌ 预览显示正确
✅/❌ 能够复制到剪贴板
✅/❌ 粘贴到公众号后格式正确
✅/❌ 标题是蓝色
✅/❌ 引用块有蓝色竖线
✅/❌ 代码块有灰色背景

浏览器版本：Chrome ___
飞书文档 URL：___
错误消息（如有）：___
截图：___
```

## 🎯 下一步优化方向

- [ ] 添加更多主题颜色（暖阳橙、清新绿等）
- [ ] 支持自定义样式
- [ ] 添加图片自动压缩
- [ ] 支持 Markdown 导出
- [ ] 添加 AI 润色功能

---

**更新时间**：2026-02-06
